<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Part 3: Working with the Code | Open Source and Reproducible MIR Research</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Part 3: Working with the Code" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hello &amp; welcome to Part 3! This is where we’ll start to use the various things you’ve installed to work with the code." />
<meta property="og:description" content="Hello &amp; welcome to Part 3! This is where we’ll start to use the various things you’ve installed to work with the code." />
<link rel="canonical" href="http://localhost:4000/ismir2018-oss-tutorial/tutorial/2018/08/14/part-3.html" />
<meta property="og:url" content="http://localhost:4000/ismir2018-oss-tutorial/tutorial/2018/08/14/part-3.html" />
<meta property="og:site_name" content="Open Source and Reproducible MIR Research" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-14T15:16:46-04:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/ismir2018-oss-tutorial/tutorial/2018/08/14/part-3.html"},"url":"http://localhost:4000/ismir2018-oss-tutorial/tutorial/2018/08/14/part-3.html","headline":"Part 3: Working with the Code","dateModified":"2018-08-14T15:16:46-04:00","datePublished":"2018-08-14T15:16:46-04:00","description":"Hello &amp; welcome to Part 3! This is where we’ll start to use the various things you’ve installed to work with the code.","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ismir2018-oss-tutorial/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/ismir2018-oss-tutorial/">Open Source and Reproducible MIR Research</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ismir2018-oss-tutorial/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Part 3:  Working with the Code</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-08-14T15:16:46-04:00" itemprop="datePublished">Aug 14, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Hello &amp; welcome to Part 3!  This is where we’ll start to use the various things you’ve installed to work with the code.</p>

<h2 id="get-the-code">Get the Code</h2>

<p>We’re going to go over some real-world basics of how git works and how conda works.
We’ll do this by getting you a copy of the code we’re going to work with on to your local machine, then installing the packages we need with conda.</p>

<p>Visit <code class="highlighter-rouge">https://github.com/bmcfee/ismir2018-oss-tutorial</code>, and press the <strong>Fork</strong> button.  You’ll be asked where to fork the code to – select your own GitHub username.  A “fork” is your own copy of our code.  You can change it without altering our code.</p>

<p>Now, visit <code class="highlighter-rouge">https://github.com/&lt;your-username&gt;/ismir2018-oss-tutorial</code>, and press the <strong>Clone</strong> button.  Make sure to select <strong>Clone with SSH</strong>, and then copy the string that looks like <code class="highlighter-rouge">git@github:&lt;your-username&gt;/ismir2018-oss-tutorial.git</code></p>

<p>Then, in your terminal, go to wherever you keep your code, and do <code class="highlighter-rouge">git clone &lt;that string&gt;</code>.  This will do a lot of stuff!  Once it is done, you should see a directory called <code class="highlighter-rouge">ismir2018-oss-tutorial</code>.</p>

<p><code class="highlighter-rouge">cd</code> into that directory, then do <code class="highlighter-rouge">ls</code>.  You should see the same files that you see on GitHub!</p>

<h4 id="checkpoint">Checkpoint</h4>

<p>From the <code class="highlighter-rouge">ismir2018-oss-tutorial</code> directory, run:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">git status</code></pre></figure>

<p>You should see:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">On branch master
Your branch is up-to-date with <span class="s1">'origin/master'</span><span class="nb">.</span>
nothing to commit, working directory clean</code></pre></figure>

<h2 id="install-things-with-conda">Install Things with Conda</h2>

<p>Conda, like we said earlier, is both a package manager and an environment manager.  A package manager just installs things for you.  An environment manager is a bit more complex – it keeps track of different independent environments, each of which can have different things installed.  So, for example, you can have one environment for this project and install the things that you need … and then have a different environment for a different project, with different packages installed!</p>

<p>This may sound like overkill, but it is very helpful in the long run.  You’ll often find that different projects have clashing requirements, and maintaining one environment per project will prevent this from getting out of hand.</p>

<p>So, let’s make one and install the code that we need!  To create an environment for this tutorial, do  <code class="highlighter-rouge">conda create --name ismir-2018</code>.  You’ll see that environment has been created at <code class="highlighter-rouge">/Users/&lt;your-user&gt;/miniconda3/envs/ismir-2018-tutorial</code>!  Hooray!  To turn it on do <code class="highlighter-rouge">conda activate ismir-2018-tutorial</code>.</p>

<p>This means that any Python code you install with conda or pip will only be installed in this environment.  If you want to get out of this environment, just run <code class="highlighter-rouge">source deactivate</code> – but don’t run it now!</p>

<p>For now, we’re going to install all the stuff we need.  Run <code class="highlighter-rouge">conda install --file requirements.txt</code>.  Lots of things should happen!</p>

<h4 id="checkpoint-1">Checkpoint</h4>

<p>Run:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">conda list</code></pre></figure>

<p>You should see something like the below – make sure that <code class="highlighter-rouge">librosa</code> is in list!</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">packages <span class="k">in </span>environment at /Users/thorkell/miniconda3:

 Name                    Version                   Build
conda                     4.5.10                   py36_0
conda-env                 2.6.0                h36134e3_0
cryptography              2.2.2            py36h1de35cc_0
cycler                    0.10.0           py36hfc81398_0
docutils                  0.14             py36hbfde631_0
flake8                    3.5.0                    py36_1
freetype                  2.9.1                hb4e5f40_0</code></pre></figure>

<h2 id="run-the-tests">Run the Tests</h2>

<p>So we’ve installed all the packages we’ll need.  Let’s run the tests.  Tests make sure that your code is doing what your think it is doing – making sure that 2 + 2 in fact comes out to 4.</p>

<p>You can find the test code in the <code class="highlighter-rouge">tests/</code> folder, and we’ll talk more about testing later in the tutorial.  For now, just run the tests with <code class="highlighter-rouge">pytest</code>.</p>

<p>💥🔥💥🔥💥🔥💥🔥💥🔥💥 <em>OH NO EVERYTHING FAILED!</em> 💥🔥💥🔥💥🔥💥🔥💥🔥💥</p>

<p>Phew, ok, this is not actually a big deal at all.  Failing tests are usually a good sign, becaue they mean that your tests found a bug or a problem.  Let’s look at the error message that pytest is showing, and see if we can fix it.</p>

<p>Ah, this does not look so bad.  We’re missing a package called <code class="highlighter-rouge">pandas</code>.  We could just install it with conda, but we want to fix this problem for the long term.  So, open up that requirements.txt file, and add the line <code class="highlighter-rouge">pandas</code> at the bottom, and the save it.  Then re-run <code class="highlighter-rouge">conda install --file requirements.txt</code>, and then run the tests again.</p>

<h4 id="checkpoint-2">Checkpoint</h4>

<p>Run:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">pytest</code></pre></figure>

<p>You should see:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">platform darwin <span class="nt">--</span> Python 3.6.5, pytest-3.7.2, py-1.5.4, pluggy-0.7.1
rootdir: /Users/thorkell/Code/bmcfee/ismir2018-oss-tutorial, inifile:
collected 5 items

tests/test_ismir2018-oss-tutorial.py .....          	                        <span class="o">[</span>100%]</code></pre></figure>

<h2 id="save-our-work">Save Our Work</h2>

<p>We fixed a bug, hooray!  But we’ve only fixed our local version.  Let’s commit this to our local git repository, and then update the version on GitHub.</p>

<p>First, make a new branch to work on. Working in a branch means that we can do whatever we want without breaking our main code.  Do <code class="highlighter-rouge">git branch update-conda-env</code>.</p>

<p>Next, add and commit your files:  <code class="highlighter-rouge">git add requirements.txt</code>, then <code class="highlighter-rouge">git commit -m "Add pandas to requirements.txt"</code></p>

<p>Rad!  We’ve saved our work locally.  To push your code to GitHub, do <code class="highlighter-rouge">git push origin update-conda-env</code>.</p>

<p>We want to get in the habit of keeping our online work up to date with our local work.  So let’s go look at GitHub, and merge this branch there.</p>
<ul>
  <li>Visit GitHub, and find your fork of this repository:  https://github.com/<your-github-username>/ismir2018-oss-tutorial/branches</your-github-username></li>
  <li>You’ll see a list of branches - select <strong>update-conda-env</strong>.</li>
  <li>You’ll see a small button that says <strong>New pull request</strong>.  Press it!</li>
  <li>This will take you to a nice web form.  Put in the reasons for your changes, and press <strong>Create Pull Request</strong>.</li>
</ul>

<p>Hooray, you’ve made a Pull Request!  Pull Requests (PRs) are the best way to contribute code to a project.  You can review &amp; comment on the proposed changes before merging them, or request that things be improved.</p>

<p>🙏 Here’s an important aside:  when discussing code in PRs, please be nice!  It’s really easy for a neutral comment to be read as mean, and it’s really easy to alienate people by being mean  You should do your best to very polite and kind when dealing with people on GitHub (and probably on computers in general).</p>

<p>With that said, let’s merge our PR!  This will add the changes from your branch to the <code class="highlighter-rouge">master</code> branch.</p>
<ul>
  <li>Press <strong>Merge</strong>.  GitHub will merge your commit into master.</li>
  <li>Now your online repo is up to date, so let’s update your local.</li>
  <li>In your command line, run <code class="highlighter-rouge">git checkout master</code>.</li>
  <li>Next, do <code class="highlighter-rouge">git pull origin master</code> to update your local copy.  You’ll see that git adds your commit from GitHub to your local copy.</li>
  <li>Finally, do <code class="highlighter-rouge">git branch -d update-conda-env</code> to delete your local branch – you’ve merged the commits to master, so you can delete it.</li>
</ul>

<h4 id="checkpoint-3">Checkpoint</h4>

<p>Run:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">git log</code></pre></figure>

<p>You should see something like this:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">commit fc48577568d259f361a2e5f28267500ff2d4405f
Author: &lt;Your Name&gt; &lt;your-email@your-server&gt;
Date:   &lt;today&gt;

    Add pandas to requirements.txt</code></pre></figure>

<p>We’ve just gone over the basic git and GitHub workflow that you should, in general, stick with: make a branch, make some changes, run tests, commit, push, merge, clean up.</p>

<p>This means that you never have untested code in master, and it means that master is always functional.  This is called “Continuous Integration”, or “Continuous Delivery”.  There are whole books about why this is a good idea, but you can read <a href="https://guides.github.com/introduction/flow/">a good summary of the GitHub version of it here</a>.</p>

<p>It also means that the online, “deployed” version of master is your primary version, and you just have a local version that you’re working on.</p>

<h2 id="success">Success!</h2>

<p>We’ve used git to check out code, modify it, and commit our modifications.  We’ve also used conda to install the code we need, in an environment that is specific to this project.  In <a href="https://bmcfee.github.io/ismir2018-oss-tutorial/tutorial/2018/08/13/part-4.html">Part 4</a>, we’ll get into the details of our Python code and how it all fits together.</p>


  </div><a class="u-url" href="/ismir2018-oss-tutorial/tutorial/2018/08/14/part-3.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ismir2018-oss-tutorial/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Open Source and Reproducible MIR Research</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Open Source and Reproducible MIR Research</li><li><a class="u-email" href="mailto:brian.mcfee@nyu.edu, thorkell@spotify.com">brian.mcfee@nyu.edu, thorkell@spotify.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/bmcfee"><svg class="svg-icon"><use xlink:href="/ismir2018-oss-tutorial/assets/minima-social-icons.svg#github"></use></svg> <span class="username">bmcfee</span></a></li><li><a href="https://www.twitter.com/functiontelechy"><svg class="svg-icon"><use xlink:href="/ismir2018-oss-tutorial/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">functiontelechy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>The goal of this tutorial is to provide hands-on,  practical training for MIR researchers to learn modern tools  for improving the quality of their research software.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
